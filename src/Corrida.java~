import java.io.Serializable;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;

public class Corrida implements Comparable<Corrida>, Serializable {
    private static final long serialVersionUID = 1L;

    private String nome;
    private LocalDate data;
    private int distancia;   // em metros
    private int tempo;       // em minutos
    private int dificuldade; // escala de esforço de 1 a 10

    // Construtor mínimo: apenas nome
    public Corrida(String nome) {
        this.nome = nome;
        this.data = null;
        this.distancia = 0;
        this.tempo = 0;
        this.dificuldade = 0;
    }

    // Getters e Setters
    public String getNome() { return nome; }
    public void setNome(String nome) { this.nome = nome; }

    public LocalDate getData() { return data; }
    public void setData(LocalDate data) { this.data = data; }

    public int getDistancia() { return distancia; }
    public void setDistancia(int distancia) { this.distancia = distancia; }

    public int getTempo() { return tempo; }
    public void setTempo(int tempo) { this.tempo = tempo; }

    public int getDificuldade() { return dificuldade; }
    public void setDificuldade(int dificuldade) { this.dificuldade = dificuldade; }

    // Ordenação natural por data (mais antigas primeiro), tratando null
    @Override
    public int compareTo(Corrida outra) {
        if (this.data == null && outra.data == null) return 0;
        if (this.data == null) return 1;
        if (outra.data == null) return -1;
        return this.data.compareTo(outra.data);
    }

    // Representação em string para exibição
    @Override
    public String toString() {
        DateTimeFormatter fmt = DateTimeFormatter.ofPattern("dd/MM/yyyy");
        String dataStr = (data != null) ? data.format(fmt) : "--/--/----";
        return String.format("%s - %s - %dm - %dmin - dif %d",
                dataStr, nome, distancia, tempo, dificuldade);
    }

    /**
     * Atualiza um campo específico com base na opção fornecida.
     * @param campo número da opção (1=nome, 2=data, 3=distancia, 4=tempo, 5=dificuldade)
     * @param valor string contendo o novo valor (o menu deve validar/converter conforme necessário)
     */
    public void modificar(int campo, String valor) {
        switch (campo) {
            case 1:
                setNome(valor);
                break;
            case 2:
                try {
                    DateTimeFormatter fmt = DateTimeFormatter.ofPattern("dd/MM/yyyy");
                    setData(LocalDate.parse(valor, fmt));
                } catch (DateTimeParseException e) {
                    // valor inválido, manter data
                }
                break;
            case 3:
                try {
                    setDistancia(Integer.parseInt(valor));
                } catch (NumberFormatException e) {
                    // inválido, manter distância
                }
                break;
            case 4:
                try {
                    setTempo(Integer.parseInt(valor));
                } catch (NumberFormatException e) {
                    // inválido, manter tempo
                }
                break;
            case 5:
                try {
                    setDificuldade(Integer.parseInt(valor));
                } catch (NumberFormatException e) {
                    // inválido, manter dificuldade
                }
                break;
            default:
                // opção inexistente
                break;
        }
    }
    public static void popularCorridas() {
        DateTimeFormatter fmt = DateTimeFormatter.ofPattern("dd/MM/yyyy");

        Corrida c1 = new Corrida("matatona ufpr 100 anos");
        c1.setData(LocalDate.now()); // Data não fornecida = hoje
        c1.setDistancia(10000);
        c1.setTempo(50);
        c1.setDificuldade(10);

        Corrida c2 = new Corrida("nduia[a");
        c2.setData(LocalDate.parse("24/09/2001", fmt));
        c2.setDistancia(1500);
        c2.setTempo(5);
        c2.setDificuldade(3);

        Corrida c3 = new Corrida("sono");
        c3.setData(LocalDate.parse("10/05/2025", fmt));
        c3.setDistancia(1200);
        c3.setTempo(2);
        c3.setDificuldade(2);

        Corrida c4 = new Corrida("maratona contra saudade");
        c4.setData(LocalDate.parse("08/04/2025", fmt));
        c4.setDistancia(5000);
        c4.setTempo(40);
        c4.setDificuldade(10);

        System.out.println("✅ Corridas cadastradas automaticamente com base na entrada do usuário!");
    }

}
